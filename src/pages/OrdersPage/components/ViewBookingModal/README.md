# ViewBookingModal

Компонент для просмотра информации о бронировании автоуслуг.

## Описание

`ViewBookingModal` - это модальное окно только для чтения, которое отображает детальную информацию о бронировании. Компонент открывается при клике на карточку бронирования в календаре и заменяет предыдущую форму редактирования (`EditBookingModal`).

## Основные возможности

- Отображение информации об автомобиле (марка, модель, госномер)
- Показ статуса бронирования с цветовой индикацией
- Список услуг с длительностью и ценой
- Возможность отмены записи с подтверждением
- Блокировка скролла при открытии
- Состояния загрузки и ошибок

## Props

```typescript
interface ViewBookingModalProps {
  isOpen: boolean;        // Флаг открытия/закрытия модального окна
  onClose: () => void;    // Callback при закрытии окна
  bookingUuid: string;    // UUID бронирования для загрузки деталей
  onUpdate: () => void;   // Callback после успешной отмены заказа
}
```

## Использование

```tsx
import ViewBookingModal from '@/pages/OrdersPage/components/ViewBookingModal';

function OrdersPage() {
  const [selectedBooking, setSelectedBooking] = useState<string | null>(null);

  const handleBookingClick = (bookingUuid: string) => {
    setSelectedBooking(bookingUuid);
  };

  const handleCloseModal = () => {
    setSelectedBooking(null);
  };

  const handleUpdateBooking = () => {
    // Перезагрузить список бронирований
    bookingsStore.fetchBookings();
  };

  return (
    <div>
      {selectedBooking && (
        <ViewBookingModal
          isOpen={selectedBooking !== null}
          onClose={handleCloseModal}
          bookingUuid={selectedBooking}
          onUpdate={handleUpdateBooking}
        />
      )}
    </div>
  );
}
```

## Статусы бронирования

Компонент поддерживает следующие статусы с соответствующими цветами:

- `pending_confirmation` - Желтый тег "Ожидает"
- `confirmed` - Синий тег "Подтвержден"
- `completed` - Зеленый тег "Завершено"
- `cancelled` - Красный тег "Отменён"

## Функциональность

### Загрузка данных

При открытии модального окна автоматически загружаются детали бронирования через `bookingsStore.fetchBookingDetails(bookingUuid)`.

### Отмена записи

Кнопка "Отменить запись" доступна только для статусов, отличных от `cancelled` и `completed`. При клике показывается системное подтверждение, после чего выполняется запрос на изменение статуса.

### Блокировка скролла

При открытии модального окна автоматически блокируется скролл основной страницы, а при закрытии восстанавливается.

## Зависимости

- `mobx-react-lite` - для реактивности через observer
- `date-fns` - для форматирования дат и времени
- `@/components/ui/AppTag` - компонент тега для отображения статуса
- `@/stores/BookingsStore` - MobX store для работы с бронированиями
- `@/hooks/useStores` - хук для доступа к stores

## Стилизация

Компонент использует CSS модули (`ViewBookingModal.css`) со следующими ключевыми характеристиками:

- Ширина: 346px
- Абсолютное позиционирование справа от календаря
- Скругление: 24px
- Цвета из дизайн-системы проекта (gray/*)
- Шрифт: Onest (Regular для текста, Medium для заголовков)

## Storybook

Компонент имеет полный набор сториз для всех состояний:

- `Default` - открытое окно со статусом "Подтвержден"
- `Closed` - закрытое модальное окно
- `PendingStatus` - статус "Ожидает"
- `CompletedStatus` - статус "Завершено"
- `CancelledStatus` - статус "Отменён"
- `WithAdditionalServices` - с дополнительными услугами
- `Loading` - состояние загрузки

## Типы данных

Компонент использует следующие типы из API:

- `DetailedBookingResponseDto` - полная информация о бронировании
- `BookingCarDto` - информация об автомобиле
- `BookingServiceDto` - информация об услуге
- `BookingStatus` - тип статуса бронирования

## Форматирование

### Дата и время
Формат: "25 сентября, 19:30-20:30"

### Госномер
Формат: "A000AA | 111" (номер + разделитель + регион)

### Услуги
Формат: "Название • Длительность • Цена" (с точками-разделителями)

### Длительность
- Менее 60 минут: "40 мин"
- Более 60 минут: "1 ч 30 мин"
- Ровное количество часов: "2 ч"

## Обработка ошибок

- При ошибке загрузки данных показывается сообщение "Не удалось загрузить информацию о бронировании"
- При ошибке отмены заказа показывается toast-уведомление через `ToastStore`
- Все ошибки логируются в консоль

## Ограничения

- Компонент только для просмотра, редактирование не поддерживается
- Единственное доступное действие - отмена записи
- Изменение статуса доступно только на "cancelled"
